{"ast":null,"code":"import _defineProperty from\"C:/Users/Admin2/OneDrive/Lambda School/Web_3.3/BuildWeek2-ContextAPI/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:/Users/Admin2/OneDrive/Lambda School/Web_3.3/BuildWeek2-ContextAPI/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/Admin2/OneDrive/Lambda School/Web_3.3/BuildWeek2-ContextAPI/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from'react';import{useHistory}from'react-router-dom';import*as yup from'yup';import productFormSchema from'../utils/productSchema';import axiosWithAuth from'../utils/axiosWithAuth';import{ProductContext}from'../contexts/ProductContext';// Setting initial form values \nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var initialFormValues={id:Date.now(),title:'',price:'',image:'https://image.freepik.com/free-vector/coming-soon-message-illuminated-with-light-projector_1284-3622.jpg',description:''};// Setting initial values for form validation error messages\nvar initialFormErrors={title:'',price:'',image:'https://image.freepik.com/free-vector/coming-soon-message-illuminated-with-light-projector_1284-3622.jpg',description:''};// Setting initial value for add item form submit button as disabled\nvar initialDisabled=true;export default function AddItemForm(props){var _useState=useState(initialFormValues),_useState2=_slicedToArray(_useState,2),formValues=_useState2[0],setFormValues=_useState2[1];var _useState3=useState(initialFormErrors),_useState4=_slicedToArray(_useState3,2),formErrors=_useState4[0],setFormErrors=_useState4[1];var _useState5=useState(initialDisabled),_useState6=_slicedToArray(_useState5,2),disabled=_useState6[0],setDisabled=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),newProducts=_useState8[0],setNewProducts=_useState8[1];var _useContext=useContext(ProductContext),setProducts=_useContext.setProducts;var _useHistory=useHistory(),push=_useHistory.push;// Using axios to post successfully submitted form with new item data to backend location\nvar postNewItem=function postNewItem(newItem){axiosWithAuth().post('http://localhost:5000/api/products',newItem).then(function(res){console.log(res.data);setProducts(res.data,{id:Date.now()});setNewProducts(res.data,{id:Date.now()});push(\"/sellers\");// Successful post returns to dashboard\n}).catch(function(err){console.log(err);}).finally(setFormValues(initialFormValues));// Form is reset regardless\n};console.log(newProducts);// Event handler functions\nvar inputChange=function inputChange(name,value){// Using yup.reach for individual form item validation\nyup.reach(productFormSchema,name).validate(value)// Clears error if validation is successful\n.then(function(){setFormErrors(_objectSpread(_objectSpread({},formErrors),{},_defineProperty({},name,'')));}).catch(function(err){setFormErrors(_objectSpread(_objectSpread({},formErrors),{},_defineProperty({},name,err.errors[0])));});setFormValues(_objectSpread(_objectSpread({},formValues),{},_defineProperty({},name,value)));};var formSubmit=function formSubmit(){var newItem={title:formValues.title.trim(),price:formValues.price.trim(),image:formValues.image.trim(),description:formValues.description.trim()};postNewItem(newItem);};// Employing an effect hook to validate the form each time it is updated so the submit button will be enabled once the form is completely valid\nuseEffect(function(){productFormSchema.isValid(formValues).then(function(valid){setDisabled(!valid);});},[formValues]);var onSubmit=function onSubmit(evt){evt.preventDefault();formSubmit();};var onCancel=function onCancel(evt){push('/sellers');};var onChange=function onChange(evt){var _evt$target=evt.target,name=_evt$target.name,value=_evt$target.value,type=_evt$target.type,checked=_evt$target.checked;var valueToUse=type==='checkbox'?checked:value;inputChange(name,valueToUse);};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"home-wrapper\",children:[/*#__PURE__*/_jsx(\"nav\",{className:\"nav\",children:/*#__PURE__*/_jsx(\"h2\",{children:\"Add a New Item\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"item-wrapper\",children:/*#__PURE__*/_jsxs(\"form\",{classame:\"form\",onSubmit:onSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsxs(\"label\",{className:\"form-row\",children:[\"Title:\",/*#__PURE__*/_jsx(\"input\",{value:formValues.name,onChange:onChange,name:\"title\",type:\"text\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"form-row\",children:[\"Price:\",/*#__PURE__*/_jsx(\"input\",{value:formValues.brand,onChange:onChange,name:\"price\",type:\"text\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"form-row\",children:[\"Image URL:\",/*#__PURE__*/_jsx(\"input\",{value:formValues.model,onChange:onChange,name:\"image\",type:\"text\"})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"form-row\",children:[\"Description:\",/*#__PURE__*/_jsx(\"input\",{value:formValues.model_no,onChange:onChange,name:\"description\",type:\"text\"})]}),/*#__PURE__*/_jsx(\"section\",{className:\"form-submit\",children:/*#__PURE__*/_jsxs(\"section\",{className:\"errors-section\",children:[/*#__PURE__*/_jsx(\"p\",{children:formErrors.name}),/*#__PURE__*/_jsx(\"p\",{children:formErrors.category}),/*#__PURE__*/_jsx(\"p\",{children:formErrors.brand}),/*#__PURE__*/_jsx(\"p\",{children:formErrors.model}),/*#__PURE__*/_jsx(\"p\",{children:formErrors.description}),/*#__PURE__*/_jsx(\"p\",{children:formErrors.min_rent}),/*#__PURE__*/_jsx(\"p\",{children:formErrors.max_rent}),/*#__PURE__*/_jsx(\"p\",{children:formErrors.price})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"buttons\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-button\",children:/*#__PURE__*/_jsx(\"button\",{disabled:disabled,id:\"submitBtn\",children:\"Add Item\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-button\",children:/*#__PURE__*/_jsx(\"button\",{onClick:onCancel,id:\"cancelBtn\",children:\"Cancel\"})})]})]})})]})});}","map":{"version":3,"sources":["C:/Users/Admin2/OneDrive/Lambda School/Web_3.3/BuildWeek2-ContextAPI/client/src/components/AddItemForm.js"],"names":["React","useState","useEffect","useContext","useHistory","yup","productFormSchema","axiosWithAuth","ProductContext","initialFormValues","id","Date","now","title","price","image","description","initialFormErrors","initialDisabled","AddItemForm","props","formValues","setFormValues","formErrors","setFormErrors","disabled","setDisabled","newProducts","setNewProducts","setProducts","push","postNewItem","newItem","post","then","res","console","log","data","catch","err","finally","inputChange","name","value","reach","validate","errors","formSubmit","trim","isValid","valid","onSubmit","evt","preventDefault","onCancel","onChange","target","type","checked","valueToUse","brand","model","model_no","category","min_rent","max_rent"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\nimport * as yup from 'yup';\r\nimport  productFormSchema  from '../utils/productSchema';\r\nimport axiosWithAuth from '../utils/axiosWithAuth';\r\nimport { ProductContext } from '../contexts/ProductContext';\r\n\r\n  // Setting initial form values \r\n  const initialFormValues = {\r\n    id: Date.now(),\r\n    title: '',   \r\n    price: '',   \r\n    image: 'https://image.freepik.com/free-vector/coming-soon-message-illuminated-with-light-projector_1284-3622.jpg',\r\n    description: '',\r\n    };\r\n\r\n  // Setting initial values for form validation error messages\r\n  const initialFormErrors = {\r\n    title: '',   \r\n    price: '',   \r\n    image: 'https://image.freepik.com/free-vector/coming-soon-message-illuminated-with-light-projector_1284-3622.jpg',\r\n    description: '',\r\n  };\r\n\r\n  // Setting initial value for add item form submit button as disabled\r\nconst initialDisabled = true;\r\n  \r\nexport default function AddItemForm(props) {\r\n  const [formValues, setFormValues] = useState(initialFormValues);\r\n  const [formErrors, setFormErrors] = useState(initialFormErrors);\r\n  const [disabled, setDisabled] = useState(initialDisabled);\r\n  const [newProducts, setNewProducts] = useState([]);\r\n  const { setProducts } = useContext(ProductContext)\r\n  const { push } = useHistory();\r\n\r\n\r\n  // Using axios to post successfully submitted form with new item data to backend location\r\n  const postNewItem = newItem => {\r\n    axiosWithAuth()\r\n    .post('http://localhost:5000/api/products', newItem) \r\n      .then((res) => {\r\n        console.log(res.data)\r\n        setProducts(res.data, { id: Date.now() })\r\n        setNewProducts(res.data, { id: Date.now() })\r\n        push(`/sellers`); // Successful post returns to dashboard\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      })\r\n\r\n      .finally(setFormValues(initialFormValues)) // Form is reset regardless\r\n  }\r\n  console.log(newProducts)\r\n\r\n  // Event handler functions\r\n  const inputChange = (name, value) => {\r\n    // Using yup.reach for individual form item validation\r\n    yup\r\n      .reach(productFormSchema, name) \r\n      .validate(value)\r\n      // Clears error if validation is successful\r\n      .then(() => {\r\n        setFormErrors({\r\n          ...formErrors,\r\n          [name]: '',\r\n        });\r\n      })\r\n      .catch((err) => {\r\n        setFormErrors({\r\n          ...formErrors,\r\n          // Validation error from schema if unsuccessful\r\n          [name]: err.errors[0],\r\n        });\r\n      })\r\n    setFormValues({\r\n      ...formValues,\r\n      [name]: value\r\n    });\r\n  }\r\n\r\n  const formSubmit = () => {\r\n    const newItem = {\r\n      title: formValues.title.trim(),\r\n      price: formValues.price.trim(),\r\n      image: formValues.image.trim(),\r\n      description: formValues.description.trim(),\r\n    };\r\n    postNewItem(newItem);\r\n  }\r\n\r\n  // Employing an effect hook to validate the form each time it is updated so the submit button will be enabled once the form is completely valid\r\n  useEffect(() => {\r\n    productFormSchema.isValid(formValues).then(valid => {\r\n      setDisabled(!valid);\r\n    });\r\n  }, [formValues])\r\n\r\n  const onSubmit = evt => {\r\n    evt.preventDefault();\r\n    formSubmit();\r\n  }\r\n\r\n  const onCancel = evt => {\r\n    push('/sellers');\r\n  }\r\n\r\n  const onChange = evt => {\r\n    const { name, value, type, checked } = evt.target;\r\n    const valueToUse = type === 'checkbox' ? checked : value;\r\n    inputChange(name, valueToUse);\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <div className='home-wrapper'>\r\n        <nav className='nav'>\r\n        <h2>Add a New Item</h2>\r\n        </nav>\r\n        <div className='item-wrapper'>\r\n          \r\n        <form classame='form' onSubmit={onSubmit}>\r\n          <div className='form-group'>\r\n            <label className='form-row'>Title:\r\n              <input\r\n                  value={formValues.name}\r\n                  onChange={onChange}\r\n                  name='title'\r\n                  type='text'\r\n                  />\r\n              </label>        \r\n            <label className='form-row'>Price:\r\n              <input\r\n                  value={formValues.brand}\r\n                  onChange={onChange}\r\n                  name='price'\r\n                  type='text'\r\n                  />\r\n              </label>\r\n            <label className='form-row'>Image URL:\r\n              <input\r\n                  value={formValues.model}\r\n                  onChange={onChange}\r\n                  name='image'\r\n                  type='text'\r\n                  />\r\n            </label>\r\n          <label className='form-row'>Description:\r\n              <input\r\n                  value={formValues.model_no}\r\n                  onChange={onChange}\r\n                  name='description'\r\n                  type='text'\r\n                  />\r\n            </label>\r\n            <section className='form-submit'>\r\n              <section className='errors-section'>\r\n                <p>{formErrors.name}</p>\r\n                <p>{formErrors.category}</p>\r\n                <p>{formErrors.brand}</p>\r\n                <p>{formErrors.model}</p>\r\n                <p>{formErrors.description}</p>\r\n                <p>{formErrors.min_rent}</p>\r\n                <p>{formErrors.max_rent}</p>\r\n                <p>{formErrors.price}</p>\r\n                </section>\r\n          </section>\r\n          </div>\r\n              <div className='buttons'>\r\n                <div className='form-button'>\r\n            <button disabled={disabled} id='submitBtn' >Add Item</button>\r\n                </div>\r\n                <div className='form-button'>\r\n                  \r\n            <button onClick={onCancel} id='cancelBtn' >Cancel</button>\r\n                </div>\r\n                \r\n          </div>\r\n        </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}"]},"metadata":{},"sourceType":"module"}
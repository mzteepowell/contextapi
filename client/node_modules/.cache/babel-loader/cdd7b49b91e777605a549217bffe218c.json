{"ast":null,"code":"import _defineProperty from\"C:/Users/Admin2/OneDrive/Lambda School/Web_3.3/BuildWeek2-ContextAPI/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:/Users/Admin2/OneDrive/Lambda School/Web_3.3/BuildWeek2-ContextAPI/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/Admin2/OneDrive/Lambda School/Web_3.3/BuildWeek2-ContextAPI/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from'react';import*as yup from'yup';import formSchema from'../utils/formSchema';import{useHistory}from'react-router-dom';import{ProductContext}from'../contexts/ProductContext';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var initialFormValues={username:'',password:''};var initialFormErrors={username:'',password:''};var initialDisabled=true;export default function LoginForm(){var _useState=useState(initialFormValues),_useState2=_slicedToArray(_useState,2),formValues=_useState2[0],setFormValues=_useState2[1];var _useState3=useState(initialFormErrors),_useState4=_slicedToArray(_useState3,2),formErrors=_useState4[0],setFormErrors=_useState4[1];var _useState5=useState(initialDisabled),_useState6=_slicedToArray(_useState5,2),disabled=_useState6[0],setDisabled=_useState6[1];var _useContext=useContext(ProductContext),setIsLoggedIn=_useContext.setIsLoggedIn;var _useHistory=useHistory(),push=_useHistory.push;var update=function update(name,value){yup.reach(formSchema,name)// get to this part of the schema\n//we can then run validate using the value\n.validate(value)// validate this value\n.then(function(){// happy path and clear the error\nsetFormErrors(_objectSpread(_objectSpread({},formErrors),{},_defineProperty({},name,\"\")));})// if the validation is unsuccessful, we can set the error message to the message\n// returned from yup (that we created in our schema)\n.catch(function(err){setFormErrors(_objectSpread(_objectSpread({},formErrors),{},_defineProperty({},name,err.errors[0])));});setFormValues(_objectSpread(_objectSpread({},formValues),{},_defineProperty({},name,value)));};useEffect(function(){formSchema.isValid(formValues).then(function(valid){return setDisabled(!valid);});},[formValues]);var onSubmit=function onSubmit(evt){evt.preventDefault();axios.post(\"https://usemytechstuff-tt26.herokuapp.com/login\",\"grant_type=password&username=\".concat(formValues.username,\"&password=\").concat(formValues.password),{headers:{Authorization:\"Basic \".concat(btoa(\"lambda-client:lambda-secret\")),\"Content-Type\":\"application/x-www-form-urlencoded\"}}).then(function(res){// console.log(\"res.data log:\", res.data);\nsetIsLoggedIn(true);localStorage.setItem(\"token\",res.data.access_token);localStorage.setItem(\"name\",formValues.username);push(\"/sellers\");console.log(localStorage.getItem(\"name\"));console.log(localStorage.getItem(\"token\"));}).catch(function(err){return console.log({err:err});});};var change=function change(evt){var _evt$target=evt.target,name=_evt$target.name,value=_evt$target.value;update(name,value);};return/*#__PURE__*/_jsxs(\"div\",{className:\"home-wrapper\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Use My Tech Stuff\"}),/*#__PURE__*/_jsx(\"div\",{className:\"item-wrapper\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"form\",onSubmit:onSubmit,children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"label\",{className:\"form-row\",children:[\"Username:\",/*#__PURE__*/_jsx(\"input\",{value:formValues.username,onChange:change,name:\"username\",type:\"text\"}),formErrors.username]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"label\",{className:\"form-row\",children:[\"Password:\",/*#__PURE__*/_jsx(\"input\",{value:formValues.password,onChange:change,name:\"password\",type:\"password\"}),formErrors.password]})}),/*#__PURE__*/_jsx(\"div\",{className:\"buttons\",children:/*#__PURE__*/_jsx(\"div\",{className:\"form-button\",children:/*#__PURE__*/_jsx(\"button\",{id:\"submitBtn\",disabled:disabled,children:\"Log In\"})})})]})})]});}","map":{"version":3,"sources":["C:/Users/Admin2/OneDrive/Lambda School/Web_3.3/BuildWeek2-ContextAPI/client/src/components/LoginForm.js"],"names":["React","useState","useEffect","useContext","yup","formSchema","useHistory","ProductContext","axios","initialFormValues","username","password","initialFormErrors","initialDisabled","LoginForm","formValues","setFormValues","formErrors","setFormErrors","disabled","setDisabled","setIsLoggedIn","push","update","name","value","reach","validate","then","catch","err","errors","isValid","valid","onSubmit","evt","preventDefault","post","headers","Authorization","btoa","res","localStorage","setItem","data","access_token","console","log","getItem","change","target"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react'\r\nimport * as yup from 'yup'\r\nimport formSchema from '../utils/formSchema'\r\nimport { useHistory } from 'react-router-dom'\r\nimport { ProductContext } from '../contexts/ProductContext';\r\nimport axios from 'axios';\r\n\r\nconst initialFormValues = {\r\n  username: '',\r\n  password: '',\r\n}\r\n\r\nconst initialFormErrors = {\r\n  username: '',\r\n  password: '',\r\n}\r\n\r\nconst initialDisabled = true\r\n\r\nexport default function LoginForm() {\r\n  const [formValues, setFormValues] = useState(initialFormValues)\r\n  const [formErrors, setFormErrors] = useState(initialFormErrors)\r\n  const [disabled, setDisabled] = useState(initialDisabled)\r\n  const { setIsLoggedIn } = useContext(ProductContext)\r\n  const { push } = useHistory();\r\n\r\n  const update = (name, value) => {\r\n    yup\r\n      .reach(formSchema, name) // get to this part of the schema\r\n      //we can then run validate using the value\r\n      .validate(value) // validate this value\r\n      .then(() => {\r\n        // happy path and clear the error\r\n        setFormErrors({\r\n          ...formErrors,\r\n          [name]: \"\",\r\n        });\r\n      })\r\n      // if the validation is unsuccessful, we can set the error message to the message\r\n      // returned from yup (that we created in our schema)\r\n      .catch((err) => {\r\n        setFormErrors({\r\n          ...formErrors,\r\n          // validation error from schema\r\n          [name]: err.errors[0],\r\n        });\r\n      });\r\n\r\n    setFormValues({\r\n      ...formValues, \r\n      [name]: value,\r\n    })\r\n  }\r\n\r\n  useEffect(() => {\r\n        formSchema.isValid(formValues).then(valid => setDisabled(!valid))\r\n      }, [formValues])\r\n\r\n  const onSubmit = (evt) => {\r\n    evt.preventDefault();\r\n    axios\r\n          .post(\r\n            \"https://usemytechstuff-tt26.herokuapp.com/login\",\r\n            `grant_type=password&username=${formValues.username}&password=${formValues.password}`, \r\n            {\r\n              headers: {\r\n                Authorization: `Basic ${btoa(\"lambda-client:lambda-secret\")}`,\r\n                \"Content-Type\": \"application/x-www-form-urlencoded\",\r\n              },\r\n            },\r\n          )\r\n          .then((res) => {\r\n            // console.log(\"res.data log:\", res.data);\r\n            setIsLoggedIn(true);\r\n            localStorage.setItem(\"token\", res.data.access_token);\r\n            localStorage.setItem(\"name\", formValues.username);\r\n            push(\"/sellers\");\r\n            console.log(localStorage.getItem(\"name\"));\r\n            console.log(localStorage.getItem(\"token\"));\r\n          })\r\n          .catch((err) => console.log({err}))\r\n  }\r\n\r\n  const change = (evt) => {\r\n        const { name, value } = evt.target;\r\n        update(name, value);\r\n  };\r\n    \r\n  return (\r\n    <div className='home-wrapper'>\r\n      <h1>Use My Tech Stuff</h1>\r\n        <div className='item-wrapper'>\r\n      <form className=\"form\" onSubmit={onSubmit}>\r\n        <div>\r\n          <label className='form-row'> \r\n            Username:\r\n            <input\r\n              value={formValues.username}\r\n              onChange={change}\r\n              name=\"username\"\r\n              type=\"text\"\r\n            />\r\n            {formErrors.username}\r\n          </label >\r\n        </div>\r\n        <div>\r\n          <label  className='form-row'>\r\n            Password:\r\n            <input\r\n              value={formValues.password}\r\n              onChange={change}\r\n              name=\"password\"\r\n              type=\"password\"\r\n            />\r\n            {formErrors.password}\r\n          </label>\r\n        </div>\r\n          <div className='buttons'>\r\n            <div className='form-button'>\r\n          <button id=\"submitBtn\"\r\n          disabled={disabled}>Log In</button>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n    </div>\r\n  )\r\n\r\n}"]},"metadata":{},"sourceType":"module"}
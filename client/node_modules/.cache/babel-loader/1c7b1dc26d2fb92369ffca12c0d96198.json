{"ast":null,"code":"import _defineProperty from\"C:/Users/Admin2/OneDrive/Lambda School/Web_3.3/BuildWeek2-ContextAPI/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"C:/Users/Admin2/OneDrive/Lambda School/Web_3.3/BuildWeek2-ContextAPI/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/Admin2/OneDrive/Lambda School/Web_3.3/BuildWeek2-ContextAPI/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import*as yup from'yup';import{signUpFormSchema}from'../utils/signUpFormSchema';import{useHistory}from'react-router-dom';import axiosWithAuth from'../utils/axiosWithAuth';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var initialFormValues={first_name:'',last_name:'',role:'',email:'',password:''};var initialFormErrors={email:'',password:''};export default function LoginForm(){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),setUser=_useState2[1];var _useState3=useState(initialFormValues),_useState4=_slicedToArray(_useState3,2),formValues=_useState4[0],setFormValues=_useState4[1];var _useState5=useState(initialFormErrors),_useState6=_slicedToArray(_useState5,2),formErrors=_useState6[0],setFormErrors=_useState6[1];var _useHistory=useHistory(),push=_useHistory.push;var onChange=function onChange(evt){var _evt$target=evt.target,name=_evt$target.name,value=_evt$target.value;yup.reach(signUpFormSchema,name)// get to this part of the schema\n//we can then run validate using the value\n.validate(value)// validate this value\n.then(function(){// happy path and clear the error\nsetFormErrors(_objectSpread(_objectSpread({},formErrors),{},_defineProperty({},name,\"\")));})// if the validation is unsuccessful, we can set the error message to the message\n// returned from yup (that we created in our schema)\n.catch(function(err){setFormErrors(_objectSpread(_objectSpread({},formErrors),{},_defineProperty({},name,err.errors[0])));});setFormValues(_objectSpread(_objectSpread({},formValues),{},_defineProperty({},name,value)));};var loginUser=function loginUser(newUser){axiosWithAuth().post('https://reqres.in/api/users',newUser).then(function(res){localStorage.setItem('token',res.data.payload);console.log(res.data);push('/products');}).catch(function(err){console.log(err);});};var onSubmit=function onSubmit(evt){evt.preventDefault();var newUser={username:formValues.email.trim(),password:formValues.password.trim()};// call to API\nloginUser(newUser);setUser(newUser);setFormValues(initialFormValues);};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"form\",{className:\"form container\",onSubmit:onSubmit,children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[\"Email:\",/*#__PURE__*/_jsx(\"input\",{value:formValues.email,onChange:onChange,name:\"email\",type:\"text\"}),formErrors.email]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"label\",{children:[\"Password:\",/*#__PURE__*/_jsx(\"input\",{value:formValues.password,onChange:onChange,name:\"password\",type:\"password\"}),formErrors.password]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{id:\"submitBtn\",children:\"Log In\"})})]})});}","map":{"version":3,"sources":["C:/Users/Admin2/OneDrive/Lambda School/Web_3.3/BuildWeek2-ContextAPI/client/src/components/LoginForm.js"],"names":["React","useState","yup","signUpFormSchema","useHistory","axiosWithAuth","initialFormValues","first_name","last_name","role","email","password","initialFormErrors","LoginForm","setUser","formValues","setFormValues","formErrors","setFormErrors","push","onChange","evt","target","name","value","reach","validate","then","catch","err","errors","loginUser","newUser","post","res","localStorage","setItem","data","payload","console","log","onSubmit","preventDefault","username","trim"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\r\nimport * as yup from 'yup'\r\nimport { signUpFormSchema } from '../utils/signUpFormSchema'\r\nimport { useHistory } from 'react-router-dom'\r\nimport axiosWithAuth from '../utils/axiosWithAuth'\r\n\r\nconst initialFormValues = {\r\n  first_name: '',\r\n  last_name: '',\r\n  role: '',\r\n  email: '',\r\n  password: '',\r\n}\r\n\r\nconst initialFormErrors = {\r\n  email: '',\r\n  password: '',\r\n}\r\n\r\nexport default function LoginForm() {\r\n\r\n  const [, setUser] = useState({})\r\n  const [formValues, setFormValues] = useState(initialFormValues)\r\n  const [formErrors, setFormErrors] = useState(initialFormErrors)\r\n  const { push } = useHistory();\r\n\r\n  const onChange = (evt) => {\r\n    const { name, value } = evt.target\r\n\r\n    yup\r\n      .reach(signUpFormSchema, name) // get to this part of the schema\r\n      //we can then run validate using the value\r\n      .validate(value) // validate this value\r\n      .then(() => {\r\n        // happy path and clear the error\r\n        setFormErrors({\r\n          ...formErrors,\r\n          [name]: \"\",\r\n        });\r\n      })\r\n      // if the validation is unsuccessful, we can set the error message to the message\r\n      // returned from yup (that we created in our schema)\r\n      .catch((err) => {\r\n        setFormErrors({\r\n          ...formErrors,\r\n          // validation error from schema\r\n          [name]: err.errors[0],\r\n        });\r\n      });\r\n\r\n    setFormValues({\r\n      ...formValues, \r\n      [name]: value,\r\n    })\r\n  }\r\n\r\n  const loginUser = (newUser) => {\r\n    axiosWithAuth()\r\n      .post('https://reqres.in/api/users', newUser)\r\n      .then(res => {\r\n        localStorage.setItem('token', res.data.payload);\r\n        console.log(res.data)\r\n        push('/products')\r\n      })\r\n      .catch(err=>{\r\n        console.log(err);\r\n      });\r\n  }\r\n\r\n  const onSubmit = (evt) => {\r\n    evt.preventDefault();\r\n\r\n    const newUser = {\r\n      username: formValues.email.trim(),\r\n      password: formValues.password.trim(),\r\n    }\r\n\r\n    // call to API\r\n    loginUser(newUser)\r\n    setUser(newUser)\r\n    setFormValues(initialFormValues)\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <form className=\"form container\" onSubmit={onSubmit}>\r\n        <div>\r\n          <label>\r\n            Email:\r\n            <input\r\n              value={formValues.email}\r\n              onChange={onChange}\r\n              name=\"email\"\r\n              type=\"text\"\r\n            />\r\n            {formErrors.email}\r\n          </label>\r\n        </div>\r\n        <div>\r\n          <label>\r\n            Password:\r\n            <input\r\n              value={formValues.password}\r\n              onChange={onChange}\r\n              name=\"password\"\r\n              type=\"password\"\r\n            />\r\n            {formErrors.password}\r\n          </label>\r\n        </div>\r\n        <div>\r\n          <button id=\"submitBtn\">Log In</button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  )\r\n\r\n}"]},"metadata":{},"sourceType":"module"}